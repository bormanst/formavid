#!/bin/bash -e
# Copyright (C) 2018 Sean Borman <bormanst@gmail.com>.
# You should have received LICENSE.txt, a copy of the
# GNU General Public License, along with this program.
# If not, see <https://www.gnu.org/licenses/>.

# set hostname

[ -n "${PASSWORDS_ONLY}" ] && exit 0

[ -z "${DOMAIN}" ] && exit 0

old=$(hostname)

for file in \
   /etc/exim4/update-exim4.conf.conf \
   /etc/printcap \
   /etc/hostname \
   /etc/hosts \
   /etc/ssh/ssh_host_rsa_key.pub \
   /etc/ssh/ssh_host_dsa_key.pub \
   /etc/ssh/ssh_host_ecdsa_key.pub \
   /etc/ssh/ssh_host_ed25519_key.pub \
   /etc/mailname \
   /etc/postfix/main.cf \
   /etc/motd \
   /etc/ssmtp/ssmtp.conf
do
   [ -f $file ] && sed -i -e "s:$old:${DOMAIN}:g" $file
done

hostname ${DOMAIN}

exit 0
